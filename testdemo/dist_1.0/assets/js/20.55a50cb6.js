(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{485:function(e,a,s){"use strict";s.r(a);var r=s(61),t=Object(r.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"swagger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#swagger"}},[e._v("#")]),e._v(" swagger")]),e._v(" "),s("h2",{attrs:{id:"命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[e._v("#")]),e._v(" 命令")]),e._v(" "),s("p",[e._v("gocore 使用 "),s("a",{attrs:{href:"https://github.com/swaggo/swag",target:"_blank",rel:"noopener noreferrer"}},[e._v("swaggo"),s("OutboundLink")],1),e._v(" 集成了 swagger 生成和服务项目。并且封装了 "),s("code",[e._v("./testdemo swagger")]),e._v(" 命令。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('[~/Documents/workspace/gocore_workspace]$ ./testdemo swagger\nswagger operator\n\nUsage:\n  gocore swagger [flags]\n  gocore swagger [command]\n\nAvailable Commands:\n  gen         generate swagger file, contain swagger.yaml, doc.go\n  serve       use gen serve\n\nFlags:\n  -h, --help   help for swagger\n\nUse "gocore swagger [command] --help" for more information about a command.\n')])])]),s("ul",[s("li",[e._v("gen  // 生成swagger文件")]),e._v(" "),s("li",[e._v("serve // 提供swagger服务")])]),e._v(" "),s("h2",{attrs:{id:"注释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注释"}},[e._v("#")]),e._v(" 注释")]),e._v(" "),s("p",[e._v("gocore 使用 "),s("a",{attrs:{href:"https://github.com/swaggo/swag",target:"_blank",rel:"noopener noreferrer"}},[e._v("swaggo"),s("OutboundLink")],1),e._v(" 来实现注释生成 swagger 功能。")]),e._v(" "),s("p",[e._v("全局注释在文件  "),s("code",[e._v("app/http/swagger.go")]),e._v(" 中:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('// Package http API.\n// @title gocore\n// @version 1.0\n// @description gocore测试\n// @termsOfService https://github.com/swaggo/swag\n\n// @contact.name yejianfeng\n// @contact.email yejianfeng\n\n// @license.name Apache 2.0\n// @license.url http://www.apache.org/licenses/LICENSE-2.0.html\n\n// @host localhost:8989\n// @BasePath /api\n// @query.collection.format multi\n\n// @securityDefinitions.basic BasicAuth\n\n// @securityDefinitions.apikey ApiKeyAuth\n// @in header\n// @name Authorization\n\n// @x-extension-openapi {"example": "value on a json format"}\n\npackage http\n\n')])])]),s("p",[e._v("接口注释请写在各自模块的 api.go 中")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("// Demo godoc\n// @Summary 获取所有用户\n// @Description 获取所有用户\n// @Produce  json\n// @Tags demo\n// @Success 200 array []UserDTO\n// @Router /demo/demo [get]\nfunc (api *DemoApi) Demo(c *gin.Context) {\n\tusers := api.service.GetUsers()\n\tusersDTO := UserModelsToUserDTOs(users)\n\tc.JSON(200, usersDTO)\n}\n")])])]),s("p",[e._v("swagger 注释的格式和关键词可以参考："),s("a",{attrs:{href:"https://github.com/swaggo/swag",target:"_blank",rel:"noopener noreferrer"}},[e._v("swaggo"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"生成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成"}},[e._v("#")]),e._v(" 生成")]),e._v(" "),s("p",[e._v("使用命令 "),s("code",[e._v("./testdemo swagger gen")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[~/Documents/workspace/gocore_workspace]$ ./testdemo swagger gen\n2020/09/16 19:57:33 Generate swagger docs....\n2020/09/16 19:57:33 Generate general API Info, search dir:./app/http/\n2020/09/16 19:57:33 Generating demo.UserDTO\n2020/09/16 19:57:33 create docs.go at /Users/Documents/workspace/gocore_workspace/app/http/swagger/docs.go\n2020/09/16 19:57:33 create swagger.json at /Users/Documents/workspace/gocore_workspace/app/http/swagger/swagger.json\n2020/09/16 19:57:33 create swagger.yaml at /Users/Documents/workspace/gocore_workspace/app/http/swagger/swagger.yaml\n")])])]),s("p",[e._v("在目录 "),s("code",[e._v("app/http/swagger/")]),e._v(" 下自动生成swagger相关文件。")]),e._v(" "),s("h2",{attrs:{id:"服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务"}},[e._v("#")]),e._v(" 服务")]),e._v(" "),s("p",[e._v("可以使用命令 "),s("code",[e._v("./testdemo swagger serve")]),e._v(" 启动当前应用的 swagger ui 服务。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[~/Documents/workspace/gocore_workspace]$ ./testdemo swagger serve\nswagger success: http://0.0.0.0:8069/swagger/index.html\nif you want to replace, remember use command: swagger gen\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("如果你的 swagger 服务已经启动，更新 swagger 只需要重新运行 "),s("code",[e._v("./testdemo swagger gen")]),e._v(" 就能更新。因为 swagger 服务读取的是生成的 swagger.json 这个文件。")])]),e._v(" "),s("p",[e._v("服务端口，我们也可以通过配置文件 "),s("code",[e._v("config/[env]/swagger.yaml")]),e._v(" 中的配置")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("url: http://127.0.0.1:8069\n")])])]),s("p",[e._v("来配置swagger serve 启动的服务。")])])}),[],!1,null,null,null);a.default=t.exports}}]);